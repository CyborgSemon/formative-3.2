let url;function checkUser(){sessionStorage.userId?($("#fab").show(),$(".devButtons").css("display","flex"),$("#noUserBtns").hide(),$("#logoutBtn").show()):($("#fab").hide(),$(".devButtons").css("display","none"),$("#logoutBtn").hide(),$("#noUserBtns").show())}$.ajax({url:"config.json",type:"GET",dataType:"json",success:function(e){url=`${e.SERVER_URL}:${e.SERVER_PORT}`,getAllItems()},error:function(){console.log("cannot find config.json file, cannot run application")}}),checkUser(),$("#register").submit(function(){if(event.preventDefault(),sessionStorage.userID)return void alert("401, permission denied");const e=$("#username").val(),l=$("#password").val(),a=$("#passwordCheck").val(),t=$("#fullName").val(),o=$("#email").val();0==e.length?console.log("please enter a username"):0==o.length?console.log("please enter an email"):0==t.length?console.log("Please enter a full name"):0==l.length?console.log("Plese enter a password"):0==a.length?console.log("Plese enter your password again"):l!=a?console.log("Your passwords do not match"):$.ajax({url:`${url}/users`,type:"POST",data:{username:e,password:l,fullName:t,email:o},success:function(e){$("#dialog2").hide(),$("#username").val(null),$("#password").val(null),$("#passwordCheck").val(null),$("#fullName").val(null),$("#email").val(null),checkUser()},error:function(e){console.log(e),console.log("Something went wrong with registering a new user")}})}),$("#login").submit(()=>{if(event.preventDefault(),sessionStorage.userId)return void alert("401, permission denied");const e=$("#lUsername").val(),l=$("#lPassword").val();$.ajax({url:`${url}/login`,type:"POST",data:{username:e,password:l},error:e=>{console.log("Somthing went wrong with logging in"),console.log(e)},success:e=>{console.log(e),sessionStorage.userId=e._id,sessionStorage.username=e.username,sessionStorage.fullName=e.fullName,sessionStorage.email=e.email,$("#dialog1").hide(),$("#lUsername").val(null),$("#lPassword").val(null),checkUser()}})}),$("#addItem").submit(()=>{event.preventDefault();let e=$("#itemName").val(),l=$("#itemDescription").val(),a=$("#itemImageUrl").val(),t=$("#itemUrl").val();0==e.length?console.log("please enter a username"):0==l.length?console.log("please enter an email"):0==a.length?console.log("Please enter a full name"):0==t.length?console.log("Plese enter a password"):$.ajax({url:`${url}/addItem`,type:"POST",data:{name:e,author:sessionStorage.fullName,url:t,imageUrl:a,description:l,userId:sessionStorage.userId},error:e=>{console.log("there was an error adding the item"),console.log(e)},success:e=>{getAllItems(),$("#dialog3").hide(),$("#itemName").val(null),$("#itemDescription").val(null),$("#itemImageUrl").val(null),$("#itemUrl").val(null)}})}),$("#editItem").submit(()=>{event.preventDefault();let e=$("#editItemName").val(),l=$("#editItemDescription").val(),a=$("#editItemImageUrl").val(),t=$("#editItemUrl").val(),o=$("#editInputId").val();0==e.length?console.log("please enter a username"):0==l.length?console.log("please enter an email"):0==a.length?console.log("Please enter a full name"):0==t.length?console.log("Plese enter a password"):$.ajax({url:`${url}/editItem`,type:"PATCH",data:{itemId:o,name:e,url:t,imageUrl:a,description:l,userId:sessionStorage.userId},error:e=>{console.log("there was an error editiing the item"),console.log(e)},success:e=>{getAllItems(),$("#dialog4").hide(),$("#editItemName").val(null),$("#editItemDescription").val(null),$("#editItemImageUrl").val(null),$("#editItemUrl").val(null)}})}),$("#deleteDelete").click(()=>{let e=$("#deleteInputId").val();$.ajax({url:`${url}/deleteItem`,type:"DELETE",data:{id:e,userId:sessionStorage.userId},error:e=>{console.log("Error deleteing item"),console.log(e)},success:l=>{$(`[data-itemid="${e}"]`).parent().parent().parent().remove(),$("#deleteInputId").val(null),$("#dialog5").hide()}})}),$("#logoutBtn").click(()=>{sessionStorage.clear(),checkUser()}),$("#loginBtn").click(()=>{$("#dialog1").show()}),$("#dialogBackground1").click(()=>{$("#dialog1").hide()}),$("#registerBtn").click(()=>{$("#dialog2").show()}),$("#dialogBackground2").click(()=>{$("#dialog2").hide()}),$("#fab").click(()=>{$("#dialog3").show()}),$("#dialogBackground3").click(()=>{$("#dialog3").hide()}),$("#dialogBackground4").click(()=>{$("#dialog4").hide(),$("#editInputId").val(null)}),$("#deleteCancel").click(()=>{$("#dialog5").hide(),$("#deleteInputId").val(null)}),$("#dialogBackground5").click(()=>{$("#dialog5").hide(),$("#deleteInputId").val(null)});let grid=document.getElementById("projects"),cards=[];function getAllItems(){$.ajax({url:`${url}/allItems`,type:"GET",error:e=>{console.log("Cant get all items"),console.log(e)},success:e=>{prepCards(e)}})}function prepCards(e){cards=[];for(var l=0;l<e.length;l++){let a;console.log(),a=sessionStorage.userId&&sessionStorage.userId==e[l].user_id?`<div class="cardButtons"><a onclick="event.stopPropagation()" href="${e[l].url}" target="_blank" class="cardLink">Take a look!</a><div class="devButtons" data-itemid="${e[l]._id}"><div class="iconButton editItemBtn" onclick="event.stopPropagation()"><i class="material-icons">edit</i></div><div class="iconButton deleteItemBtn" onclick="event.stopPropagation()"><i class="material-icons">delete</i></div></div></div>`:`<div class="cardButtons"><a onclick="event.stopPropagation()" href="${e[l].url}" target="_blank" class="cardLink">Take a look!</a></div>`,cards.push(`<div class="card">\n        <div class="cardImage">\n        <img src="${e[l].imageUrl}">\n        </div>\n        <div class="cardText">\n        <span class="cardTitle">${e[l].name}</span>\n        <span class="cardAuthor">${e[l].author}</span>\n        <p class="cardDescription">\n        ${e[l].description}\n        ${a}\n        </p>\n        </div>\n        </div>`)}loadCards(document.body.clientWidth)}function loadCards(e,l=!1){let a;projects.innerHTML=null,e<460?($(".column").css("width","100%"),projects.innerHTML='<div class="column" data-colNum="1"></div>',a=1):e<720?($(".column").css("width","50%"),projects.innerHTML='<div class="column" data-colNum="1"></div><div class="column" data-colNum="2"></div>',a=2):e<=1024?($(".column").css("width","33.333%"),projects.innerHTML='<div class="column" data-colNum="1"></div><div class="column" data-colNum="2"></div><div class="column" data-colNum="3"></div>',a=3):e>1024&&($(".column").css("width","25%"),projects.innerHTML='<div class="column" data-colNum="1"></div><div class="column" data-colNum="2"></div><div class="column" data-colNum="3"></div><div class="column" data-colNum="4"></div>',a=4);for(let e=0;e<cards.length;e++)document.querySelector(`[data-colNum="${e%a+1}"]`).innerHTML+=cards[e];[].forEach.call(document.querySelectorAll(".card"),e=>{e.addEventListener("click",()=>{e.classList.contains("active")?e.classList.remove("active"):([].forEach.call(document.querySelectorAll(".card"),e=>{e.classList.remove("active")}),e.classList.add("active"))})}),[].forEach.call(document.querySelectorAll(".editItemBtn"),e=>{e.addEventListener("click",()=>{$("#editInputId").val(e.parentNode.dataset.itemid),$(".projectName").text(e.parentNode.parentNode.parentNode.children[0].innerText),$("#dialog4").show(),$.ajax({url:`${url}/oneItem`,type:"POST",data:{itemId:e.parentNode.dataset.itemid},error:e=>{console.log("Error finding item"),console.log(e)},success:e=>{$("#editItemName").val(e.name),$("#editItemDescription").val(e.description),$("#editItemImageUrl").val(e.imageUrl),$("#editItemUrl").val(e.url)}})})}),[].forEach.call(document.querySelectorAll(".deleteItemBtn"),e=>{e.addEventListener("click",()=>{$("#deleteInputId").val(e.parentNode.dataset.itemid),$(".projectName").text(e.parentNode.parentNode.parentNode.children[0].innerText),$("#dialog5").show()})}),checkUser()}$(window).resize(function(){loadCards(document.body.clientWidth)});